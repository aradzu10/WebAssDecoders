#include <stdio.h>
#include <iostream>
#include <fstream>
#include "AES.h"
#include <cassert>
#include <cstring>
using namespace std;

// EM_JS(void, run_code, (const char* str), {
    //  eval(UTF8ToString(str));
// });

int main() {
    FILE *outfile;
    AES aes(256);
    unsigned char *out;
    int plain_len = 36;
    unsigned int len = 48;
    outfile = fopen ("C:/Projects/WebAssDecoders/phase4/code/encrypted.txt", "rb");
    fread (out , sizeof(unsigned char), len, outfile);
    
    unsigned char iv[] = { 0x41, 0x64, 0xcd, 0xf1, 0x2c, 0x8d, 0xbb, 0x77, 0x66, 0x22, 0x3c, 0x0d, 0xdd, 0x0f, 0xfd, 0x4e };
    unsigned char key[] = { 0x55, 0xd0, 0x32, 0x78, 0x16, 0x32, 0x47, 0x4e, 0xb8, 0x66, 0x69, 0x66, 0x08, 0x1d, 0x66, 0xb9, 0xdf, 0xba, 0x14, 0x0f, 0x96, 0xdf, 0x70, 0x52, 0xbf, 0x87, 0xfe, 0xdf, 0x7d, 0xcd, 0x21, 0xd6 };
    unsigned char *innew = aes.DecryptCBC(out, len * sizeof(unsigned char), key, iv, plain_len);
    // run_code(innew);
}